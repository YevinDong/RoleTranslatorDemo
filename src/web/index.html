<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        const url = "http://localhost:8000/stream?user_input=我把SQL读写速度提升了301%&thread_id=thread-4"
        const evtSource = new EventSource(url);

        evtSource.addEventListener("send", e => {
            const obj = JSON.parse(e.data);
            console.log('SSE 收到', obj);
        })
        evtSource.addEventListener('end', e => {
            console.log('收到结束事件:', e.data);
            evtSource.close(); // 关闭连接
        });

        evtSource.onerror = e => {
            console.log('SSE 错误:', e);
            evtSource.close(); // 发生错误时也关闭连接
        };
    </script>
</body>

</html>